/**
 * OverType v1.0.0
 * A lightweight markdown editor library with perfect WYSIWYG alignment
 * @license MIT
 * @author Demo User
 * https://github.com/demo/overtype
 */
var OverType=(()=>{var M=Object.defineProperty;var fe=Object.getOwnPropertyDescriptor;var ge=Object.getOwnPropertyNames;var ve=Object.prototype.hasOwnProperty;var ye=(n,e,t)=>e in n?M(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var be=(n,e)=>{for(var t in e)M(n,t,{get:e[t],enumerable:!0})},we=(n,e,t,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of ge(e))!ve.call(n,r)&&r!==t&&M(n,r,{get:()=>e[r],enumerable:!(o=fe(e,r))||o.enumerable});return n};var ke=n=>we(M({},"__esModule",{value:!0}),n);var A=(n,e,t)=>(ye(n,typeof e!="symbol"?e+"":e,t),t);var Fe={};be(Fe,{OverType:()=>x,default:()=>Ne});var B=class{static escapeHtml(e){let t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return e.replace(/[&<>"']/g,o=>t[o])}static preserveIndentation(e,t){let r=t.match(/^(\s*)/)[1].replace(/ /g,"&nbsp;");return e.replace(/^\s*/,r)}static parseHeader(e){return e.replace(/^(#{1,3})\s(.+)$/,(t,o,r)=>{let i=o.length;return`<span class="header ${["h1","h2","h3"][i-1]}"><span class="syntax-marker">${o}</span> ${r}</span>`})}static parseHorizontalRule(e){return e.match(/^(-{3,}|\*{3,}|_{3,})$/)?`<div><span class="hr-marker">${e}</span></div>`:null}static parseBlockquote(e){return e.replace(/^&gt; (.+)$/,(t,o)=>`<span class="blockquote"><span class="syntax-marker">&gt;</span> ${o}</span>`)}static parseBulletList(e){return e.replace(/^((?:&nbsp;)*)([-*])\s(.+)$/,(t,o,r,i)=>`${o}<span class="syntax-marker">${r}</span> ${i}`)}static parseNumberedList(e){return e.replace(/^((?:&nbsp;)*)(\d+\.)\s(.+)$/,(t,o,r,i)=>`${o}<span class="syntax-marker">${r}</span> ${i}`)}static parseCodeBlock(e){return e.startsWith("```")?`<div><span class="code-fence">${e}</span></div>`:null}static parseBold(e){return e=e.replace(/\*\*(.+?)\*\*/g,'<strong><span class="syntax-marker">**</span>$1<span class="syntax-marker">**</span></strong>'),e=e.replace(/__(.+?)__/g,'<strong><span class="syntax-marker">__</span>$1<span class="syntax-marker">__</span></strong>'),e}static parseItalic(e){return e=e.replace(new RegExp("(?<!\\*)\\*(?!\\*)(.+?)(?<!\\*)\\*(?!\\*)","g"),'<em><span class="syntax-marker">*</span>$1<span class="syntax-marker">*</span></em>'),e=e.replace(new RegExp("(?<!_)_(?!_)(.+?)(?<!_)_(?!_)","g"),'<em><span class="syntax-marker">_</span>$1<span class="syntax-marker">_</span></em>'),e}static parseInlineCode(e){return e.replace(/`(.+?)`/g,'<code><span class="syntax-marker">`</span>$1<span class="syntax-marker">`</span></code>')}static parseLinks(e){return e.replace(/\[(.+?)\]\((.+?)\)/g,'<a href="$2"><span class="syntax-marker">[</span>$1<span class="syntax-marker">](</span><span class="syntax-marker">$2</span><span class="syntax-marker">)</span></a>')}static parseInlineElements(e){let t=e;return t=this.parseInlineCode(t),t=this.parseLinks(t),t=this.parseBold(t),t=this.parseItalic(t),t}static parseLine(e){let t=this.escapeHtml(e);t=this.preserveIndentation(t,e);let o=this.parseHorizontalRule(t);if(o)return o;let r=this.parseCodeBlock(t);return r||(t=this.parseHeader(t),t=this.parseBlockquote(t),t=this.parseBulletList(t),t=this.parseNumberedList(t),t=this.parseInlineElements(t),t.trim()===""?"<div>&nbsp;</div>":`<div>${t}</div>`)}static parse(e,t=-1,o=!1){return e.split(`
`).map((s,a)=>o&&a===t?`<div class="raw-line">${this.escapeHtml(s)||"&nbsp;"}</div>`:this.parseLine(s)).join("")}};var xe=Object.defineProperty,D=Object.getOwnPropertySymbols,Se=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable,K=(n,e,t)=>e in n?xe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,F=(n,e)=>{for(var t in e||(e={}))Se.call(e,t)&&K(n,t,e[t]);if(D)for(var t of D(e))Le.call(e,t)&&K(n,t,e[t]);return n};function Ce(){return{prefix:"",suffix:"",blockPrefix:"",blockSuffix:"",multiline:!1,replaceNext:"",prefixSpace:!1,scanFor:"",surroundWithNewlines:!1,orderedList:!1,unorderedList:!1,trimFirst:!1}}function Ee(n){return F(F({},Ce()),n)}function V(n){return n.trim().split(`
`).length>1}function Z(n,e){return Array(e+1).join(n)}function Ae(n,e){let t=e;for(;n[t]&&n[t-1]!=null&&!n[t-1].match(/\s/);)t--;return t}function Be(n,e,t){let o=e,r=t?/\n/:/\s/;for(;n[o]&&!n[o].match(r);)o++;return o}function Ie(n){let e=n.value.split(`
`),t=0;for(let o=0;o<e.length;o++){let r=e[o].length+1;n.selectionStart>=t&&n.selectionStart<t+r&&(n.selectionStart=t),n.selectionEnd>=t&&n.selectionEnd<t+r&&(n.selectionEnd=t+r-1),t+=r}}function Te(n,e,t,o=!1){if(n.selectionStart===n.selectionEnd)n.selectionStart=Ae(n.value,n.selectionStart),n.selectionEnd=Be(n.value,n.selectionEnd,o);else{let r=n.selectionStart-e.length,i=n.selectionEnd+t.length,s=n.value.slice(r,n.selectionStart)===e,a=n.value.slice(n.selectionEnd,i)===t;s&&a&&(n.selectionStart=r,n.selectionEnd=i)}return n.value.slice(n.selectionStart,n.selectionEnd)}function W(n){let e=n.value.slice(0,n.selectionStart),t=n.value.slice(n.selectionEnd),o=e.match(/\n*$/),r=t.match(/^\n*/),i=o?o[0].length:0,s=r?r[0].length:0,a,c;return e.match(/\S/)&&i<2&&(a=Z(`
`,2-i)),t.match(/\S/)&&s<2&&(c=Z(`
`,2-s)),a==null&&(a=""),c==null&&(c=""),{newlinesToAppend:a,newlinesToPrepend:c}}var L=null;function Me(n,{text:e,selectionStart:t,selectionEnd:o}){let r=n.selectionStart,i=n.value.slice(0,r),s=n.value.slice(n.selectionEnd);if(L===null||L===!0){n.contentEditable="true";try{L=document.execCommand("insertText",!1,e)}catch(a){L=!1}n.contentEditable="false"}if(L&&!n.value.slice(0,n.selectionStart).endsWith(e)&&(L=!1),!L){try{document.execCommand("ms-beginUndoUnit")}catch(a){}n.value=i+e+s;try{document.execCommand("ms-endUndoUnit")}catch(a){}n.dispatchEvent(new CustomEvent("input",{bubbles:!0,cancelable:!0}))}t!=null&&o!=null?n.setSelectionRange(t,o):n.setSelectionRange(r,n.selectionEnd)}function _e(n,e){let t,o,{prefix:r,suffix:i,blockPrefix:s,blockSuffix:a,replaceNext:c,prefixSpace:y,scanFor:l,surroundWithNewlines:h}=e,f=n.selectionStart,b=n.selectionEnd,p=n.value.slice(n.selectionStart,n.selectionEnd),u=V(p)&&s.length>0?`${s}
`:r,g=V(p)&&a.length>0?`
${a}`:i;if(y){let v=n.value[n.selectionStart-1];n.selectionStart!==0&&v!=null&&!v.match(/\s/)&&(u=` ${u}`)}p=Te(n,u,g,e.multiline);let m=n.selectionStart,w=n.selectionEnd,me=c.length>0&&g.indexOf(c)>-1&&p.length>0;if(h){let v=W(n);t=v.newlinesToAppend,o=v.newlinesToPrepend,u=t+r,g+=o}if(p.startsWith(u)&&p.endsWith(g)){let v=p.slice(u.length,p.length-g.length);if(f===b){let k=f-u.length;k=Math.max(k,m),k=Math.min(k,m+v.length),m=w=k}else w=m+v.length;return{text:v,selectionStart:m,selectionEnd:w}}else if(me)if(l.length>0&&p.match(l)){g=g.replace(c,p);let v=u+p+g;return m=w=m+u.length,{text:v,selectionStart:m,selectionEnd:w}}else{let v=u+p+g;return m=m+u.length+p.length+g.indexOf(c),w=m+c.length,{text:v,selectionStart:m,selectionEnd:w}}else{let v=u+p+g;m=f+u.length,w=b+u.length;let k=p.match(/^\s*|\s*$/g);if(e.trimFirst&&k){let q=k[0]||"",R=k[1]||"";v=q+u+p.trim()+g+R,m+=q.length,w-=R.length}return{text:v,selectionStart:m,selectionEnd:w}}}function $e(n,e){let{prefix:t,suffix:o,surroundWithNewlines:r}=e,i=n.value.slice(n.selectionStart,n.selectionEnd),s=n.selectionStart,a=n.selectionEnd,c=i.split(`
`);if(c.every(l=>l.startsWith(t)&&l.endsWith(o)))i=c.map(l=>l.slice(t.length,l.length-o.length)).join(`
`),a=s+i.length;else if(i=c.map(l=>t+l+o).join(`
`),r){let{newlinesToAppend:l,newlinesToPrepend:h}=W(n);s+=l.length,a=s+i.length,i=l+i+h}return{text:i,selectionStart:s,selectionEnd:a}}function U(n){let e=n.split(`
`),t=/^\d+\.\s+/,o=e.every(i=>t.test(i)),r=e;return o&&(r=e.map(i=>i.replace(t,""))),{text:r.join(`
`),processed:o}}function G(n){let e=n.split(`
`),t="- ",o=e.every(i=>i.startsWith(t)),r=e;return o&&(r=e.map(i=>i.slice(t.length,i.length))),{text:r.join(`
`),processed:o}}function I(n,e){return e?"- ":`${n+1}. `}function je(n,e){let t,o,r;return n.orderedList?(o=U(e),t=G(o.text),r=t.text):(o=G(e),t=U(o.text),r=t.text),[o,t,r]}function Oe(n,e){let t=n.selectionStart===n.selectionEnd,o=n.selectionStart,r=n.selectionEnd;Ie(n);let i=n.value.slice(n.selectionStart,n.selectionEnd),[s,a,c]=je(e,i),y=c.split(`
`).map((u,g)=>`${I(g,e.unorderedList)}${u}`),l=y.reduce((u,g,m)=>u+I(m,e.unorderedList).length,0),h=y.reduce((u,g,m)=>u+I(m,!e.unorderedList).length,0);if(s.processed)return t?(o=Math.max(o-I(0,e.unorderedList).length,0),r=o):(o=n.selectionStart,r=n.selectionEnd-l),{text:c,selectionStart:o,selectionEnd:r};let{newlinesToAppend:f,newlinesToPrepend:b}=W(n),p=f+y.join(`
`)+b;return t?(o=Math.max(o+I(0,e.unorderedList).length+f.length,0),r=o):a.processed?(o=Math.max(n.selectionStart+f.length,0),r=n.selectionEnd+f.length+l-h):(o=Math.max(n.selectionStart+f.length,0),r=n.selectionEnd+f.length+l),{text:p,selectionStart:o,selectionEnd:r}}function He(n,e){let t=n.value.slice(n.selectionStart,n.selectionEnd),o;e.orderedList||e.unorderedList?o=Oe(n,e):e.multiline&&V(t)?o=$e(n,e):o=_e(n,e),Me(n,o)}function Pe(n){if(!n)return[];let e=[],{selectionStart:t,selectionEnd:o,value:r}=n,i=r.split(`
`),s=0,a="";for(let h of i){if(t>=s&&t<=s+h.length){a=h;break}s+=h.length+1}a.startsWith("- ")&&(a.startsWith("- [ ] ")||a.startsWith("- [x] ")?e.push("task-list"):e.push("bullet-list")),/^\d+\.\s/.test(a)&&e.push("numbered-list"),a.startsWith("> ")&&e.push("quote"),a.startsWith("# ")&&e.push("header"),a.startsWith("## ")&&e.push("header-2"),a.startsWith("### ")&&e.push("header-3");let c=Math.max(0,t-10),y=Math.min(r.length,o+10),l=r.slice(c,y);if(l.includes("**")){let h=r.slice(Math.max(0,t-100),t),f=r.slice(o,Math.min(r.length,o+100)),b=h.lastIndexOf("**"),p=f.indexOf("**");b!==-1&&p!==-1&&e.push("bold")}if(l.includes("_")){let h=r.slice(Math.max(0,t-100),t),f=r.slice(o,Math.min(r.length,o+100)),b=h.lastIndexOf("_"),p=f.indexOf("_");b!==-1&&p!==-1&&e.push("italic")}if(l.includes("`")){let h=r.slice(Math.max(0,t-100),t),f=r.slice(o,Math.min(r.length,o+100));h.includes("`")&&f.includes("`")&&e.push("code")}if(l.includes("[")&&l.includes("]")){let h=r.slice(Math.max(0,t-100),t),f=r.slice(o,Math.min(r.length,o+100)),b=h.lastIndexOf("["),p=f.indexOf("]");b!==-1&&p!==-1&&r.slice(o+p+1,o+p+10).startsWith("(")&&e.push("link")}return e}var S={bold:{prefix:"**",suffix:"**",trimFirst:!0},italic:{prefix:"_",suffix:"_",trimFirst:!0},code:{prefix:"`",suffix:"`",blockPrefix:"```",blockSuffix:"```"},link:{prefix:"[",suffix:"](url)",replaceNext:"url",scanFor:"https?://"},quote:{prefix:"> ",multiline:!0,surroundWithNewlines:!0},bulletList:{prefix:"- ",multiline:!0,unorderedList:!0},numberedList:{prefix:"1. ",multiline:!0,orderedList:!0},header1:{prefix:"# "},header2:{prefix:"## "},header3:{prefix:"### "},header4:{prefix:"#### "},header5:{prefix:"##### "},header6:{prefix:"###### "}};function E(n,e){let t=Ee(e);n.focus(),He(n,t)}function _(n){!n||n.disabled||n.readOnly||E(n,S.bold)}function $(n){!n||n.disabled||n.readOnly||E(n,S.italic)}function Q(n){!n||n.disabled||n.readOnly||E(n,S.code)}function j(n,e={}){if(!n||n.disabled||n.readOnly)return;let t=F({},S.link);if(e.url&&(t.suffix=`](${e.url})`,t.replaceNext=""),e.text&&!n.value.slice(n.selectionStart,n.selectionEnd)){let o=n.selectionStart;n.value=n.value.slice(0,o)+e.text+n.value.slice(o),n.selectionStart=o,n.selectionEnd=o+e.text.length}E(n,t)}function O(n){!n||n.disabled||n.readOnly||E(n,S.bulletList)}function H(n){!n||n.disabled||n.readOnly||E(n,S.numberedList)}function P(n,e=1){if(!n||n.disabled||n.readOnly)return;(e<1||e>6)&&(e=1);let t=`header${e}`,o=S[t]||S.header1,r=n.value,i=n.selectionStart,s=i,a=i;for(;s>0&&r[s-1]!==`
`;)s--;for(;a<r.length&&r[a]!==`
`;)a++;n.selectionStart=s,n.selectionEnd=a;let y=r.slice(s,a).replace(/^#{1,6}\s*/,""),l=o.prefix+y,h=n.selectionStart;n.value=r.slice(0,s)+l+r.slice(a),n.selectionStart=s+o.prefix.length,n.selectionEnd=s+l.length}function J(n){return Pe(n)}var T=class{constructor(e){this.editor=e,this.textarea=e.textarea}handleKeydown(e){if(!(navigator.platform.toLowerCase().includes("mac")?e.metaKey:e.ctrlKey))return!1;let r=null;switch(e.key.toLowerCase()){case"b":e.shiftKey||(r="toggleBold");break;case"i":e.shiftKey||(r="toggleItalic");break;case"k":e.shiftKey||(r="insertLink");break;case"7":e.shiftKey&&(r="toggleNumberedList");break;case"8":e.shiftKey&&(r="toggleBulletList");break}return r?(e.preventDefault(),this.editor.toolbar?this.editor.toolbar.handleAction(r):this.handleAction(r),!0):!1}async handleAction(e){let t=this.textarea;if(t){t.focus();try{switch(e){case"toggleBold":_(t);break;case"toggleItalic":$(t);break;case"insertLink":j(t);break;case"toggleBulletList":O(t);break;case"toggleNumberedList":H(t);break}t.dispatchEvent(new Event("input",{bubbles:!0}))}catch(o){console.error("Error in markdown action:",o)}}}destroy(){}};var C={name:"solar",colors:{bgPrimary:"#faf0ca",bgSecondary:"#ffffff",text:"#0d3b66",h1:"#f95738",h2:"#ee964b",h3:"#3d8a51",strong:"#ee964b",em:"#f95738",link:"#0d3b66",code:"#0d3b66",codeBg:"rgba(244, 211, 94, 0.4)",blockquote:"#5a7a9b",hr:"#5a7a9b",syntaxMarker:"rgba(13, 59, 102, 0.52)",cursor:"#f95738",selection:"rgba(244, 211, 94, 0.4)",listMarker:"#ee964b"}},Y={name:"cave",colors:{bgPrimary:"#141E26",bgSecondary:"#1D2D3E",text:"#c5dde8",h1:"#d4a5ff",h2:"#f6ae2d",h3:"#9fcfec",strong:"#f6ae2d",em:"#9fcfec",link:"#9fcfec",code:"#c5dde8",codeBg:"#1a232b",blockquote:"#9fcfec",hr:"#c5dde8",syntaxMarker:"rgba(159, 207, 236, 0.73)",cursor:"#f26419",selection:"rgba(51, 101, 138, 0.4)",listMarker:"#f6ae2d"}},ee={solar:C,cave:Y,light:C,dark:Y};function z(n){return typeof n=="string"?{...ee[n]||ee.solar,name:n}:n}function te(n){let e=[];for(let[t,o]of Object.entries(n)){let r=t.replace(/([A-Z])/g,"-$1").toLowerCase();e.push(`--${r}: ${o};`)}return e.join(`
`)}function ne(n,e={}){return{...n,colors:{...n.colors,...e}}}function oe(n={}){let{fontSize:e="14px",lineHeight:t=1.6,fontFamily:o="'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace",padding:r="20px",theme:i=null,mobile:s={}}=n,a=Object.keys(s).length>0?`
    @media (max-width: 640px) {
      .overtype-wrapper .overtype-input,
      .overtype-wrapper .overtype-preview {
        ${Object.entries(s).map(([y,l])=>`${y.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${l} !important;`).join(`
        `)}
      }
    }
  `:"",c=i&&i.colors?te(i.colors):"";return`
    /* OverType Editor Styles */
    .overtype-wrapper {
      position: relative !important;
      width: 100% !important;
      height: 100% !important;
      overflow: hidden !important;
      background: var(--bg-secondary, #ffffff) !important;
      ${c?`
      /* Theme Variables */
      ${c}`:""}
    }

    /* Critical alignment styles - must be identical for both layers */
    .overtype-wrapper .overtype-input,
    .overtype-wrapper .overtype-preview {
      /* Positioning - must be identical */
      position: absolute !important;
      top: 0 !important;
      left: 0 !important;
      width: 100% !important;
      height: 100% !important;
      
      /* Font properties - any difference breaks alignment */
      font-family: ${o} !important;
      font-size: var(--instance-font-size, ${e}) !important;
      line-height: var(--instance-line-height, ${t}) !important;
      font-weight: normal !important;
      font-style: normal !important;
      font-variant: normal !important;
      font-stretch: normal !important;
      font-kerning: none !important;
      font-feature-settings: normal !important;
      
      /* Box model - must match exactly */
      padding: var(--instance-padding, ${r}) !important;
      margin: 0 !important;
      border: none !important;
      outline: none !important;
      box-sizing: border-box !important;
      
      /* Text layout - critical for character positioning */
      white-space: pre-wrap !important;
      word-wrap: break-word !important;
      word-break: normal !important;
      overflow-wrap: break-word !important;
      tab-size: 2 !important;
      -moz-tab-size: 2 !important;
      text-align: left !important;
      text-indent: 0 !important;
      letter-spacing: normal !important;
      word-spacing: normal !important;
      
      /* Text rendering */
      text-transform: none !important;
      text-rendering: auto !important;
      -webkit-font-smoothing: auto !important;
      -webkit-text-size-adjust: 100% !important;
      
      /* Direction and writing */
      direction: ltr !important;
      writing-mode: horizontal-tb !important;
      unicode-bidi: normal !important;
      text-orientation: mixed !important;
      
      /* Visual effects that could shift perception */
      text-shadow: none !important;
      filter: none !important;
      transform: none !important;
      zoom: 1 !important;
      
      /* Vertical alignment */
      vertical-align: baseline !important;
      
      /* Size constraints */
      min-width: 0 !important;
      min-height: 0 !important;
      max-width: none !important;
      max-height: none !important;
      
      /* Overflow */
      overflow-y: auto !important;
      overflow-x: auto !important;
      scrollbar-width: auto !important;
      scrollbar-gutter: auto !important;
      
      /* Animation/transition - disabled to prevent movement */
      animation: none !important;
      transition: none !important;
    }

    /* Input layer styles */
    .overtype-wrapper .overtype-input {
      /* Layer positioning */
      z-index: 1 !important;
      
      /* Text visibility */
      color: transparent !important;
      caret-color: var(--cursor, #f95738) !important;
      background-color: transparent !important;
      
      /* Textarea-specific */
      resize: none !important;
      appearance: none !important;
      -webkit-appearance: none !important;
      -moz-appearance: none !important;
      
      /* Prevent mobile zoom on focus */
      touch-action: manipulation !important;
      
      /* Disable autofill and spellcheck */
      autocomplete: off !important;
      autocorrect: off !important;
      autocapitalize: off !important;
      spellcheck: false !important;
    }

    .overtype-wrapper .overtype-input::selection {
      background-color: var(--selection, rgba(244, 211, 94, 0.4));
    }

    /* Preview layer styles */
    .overtype-wrapper .overtype-preview {
      /* Layer positioning */
      z-index: 0 !important;
      pointer-events: none !important;
      color: var(--text, #0d3b66) !important;
      background-color: transparent !important;
      
      /* Prevent text selection */
      user-select: none !important;
      -webkit-user-select: none !important;
      -moz-user-select: none !important;
      -ms-user-select: none !important;
    }

    /* Defensive styles for preview child divs */
    .overtype-wrapper .overtype-preview div {
      /* Reset any inherited styles */
      margin: 0 !important;
      padding: 0 !important;
      border: none !important;
      text-align: left !important;
      text-indent: 0 !important;
      display: block !important;
      position: static !important;
      transform: none !important;
      min-height: 0 !important;
      max-height: none !important;
      line-height: inherit !important;
      font-size: inherit !important;
      font-family: inherit !important;
    }

    /* Markdown element styling - NO SIZE CHANGES */
    .overtype-wrapper .overtype-preview .header {
      font-weight: bold !important;
    }

    /* Header colors */
    .overtype-wrapper .overtype-preview .h1 { 
      color: var(--h1, #f95738) !important; 
    }
    .overtype-wrapper .overtype-preview .h2 { 
      color: var(--h2, #ee964b) !important; 
    }
    .overtype-wrapper .overtype-preview .h3 { 
      color: var(--h3, #3d8a51) !important; 
    }

    /* Bold text */
    .overtype-wrapper .overtype-preview strong {
      color: var(--strong, #ee964b) !important;
      font-weight: bold !important;
    }

    /* Italic text */
    .overtype-wrapper .overtype-preview em {
      color: var(--em, #f95738) !important;
      text-decoration-color: var(--em, #f95738) !important;
      text-decoration-thickness: 1px !important;
      font-style: italic !important;
    }

    /* Inline code */
    .overtype-wrapper .overtype-preview code {
      background: var(--code-bg, rgba(244, 211, 94, 0.4)) !important;
      color: var(--code, #0d3b66) !important;
      padding: 0 !important;
      border-radius: 2px !important;
      font-family: inherit !important;
      font-weight: normal !important;
    }

    /* Code blocks */
    .overtype-wrapper .overtype-preview pre {
      background: #1e1e1e !important;
      padding: 0 !important;
      margin: 0 !important;
      border-radius: 4px !important;
      overflow-x: auto !important;
    }

    .overtype-wrapper .overtype-preview pre code {
      background: none !important;
    }

    /* Blockquotes */
    .overtype-wrapper .overtype-preview .blockquote {
      color: var(--blockquote, #5a7a9b) !important;
      padding: 0 !important;
      margin: 0 !important;
      border: none !important;
    }

    /* Links */
    .overtype-wrapper .overtype-preview a {
      color: var(--link, #0d3b66) !important;
      text-decoration: underline !important;
      font-weight: normal !important;
    }

    .overtype-wrapper .overtype-preview a:hover {
      text-decoration: underline !important;
      color: var(--link, #0d3b66) !important;
    }

    /* Lists - no list styling */
    .overtype-wrapper .overtype-preview ul,
    .overtype-wrapper .overtype-preview ol {
      list-style: none !important;
      margin: 0 !important;
      padding: 0 !important;
    }

    .overtype-wrapper .overtype-preview li {
      margin: 0 !important;
      padding: 0 !important;
      list-style: none !important;
    }

    /* Horizontal rules */
    .overtype-wrapper .overtype-preview hr {
      border: none !important;
      color: var(--hr, #5a7a9b) !important;
      margin: 0 !important;
      padding: 0 !important;
    }

    .overtype-wrapper .overtype-preview .hr-marker {
      color: var(--hr, #5a7a9b) !important;
      opacity: 0.6 !important;
    }

    /* Code fence markers - with background when not in code block */
    .overtype-wrapper .overtype-preview .code-fence {
      color: var(--code, #0d3b66) !important;
      background: var(--code-bg, rgba(244, 211, 94, 0.4)) !important;
    }
    
    /* Code block lines - background for entire code block */
    .overtype-wrapper .overtype-preview .code-block-line {
      background: var(--code-bg, rgba(244, 211, 94, 0.4)) !important;
    }
    
    /* Remove background from code fence when inside code block line */
    .overtype-wrapper .overtype-preview .code-block-line .code-fence {
      background: transparent !important;
    }

    /* Raw markdown line */
    .overtype-wrapper .overtype-preview .raw-line {
      color: var(--raw-line, #5a7a9b) !important;
      font-style: normal !important;
      font-weight: normal !important;
    }

    /* Syntax markers */
    .overtype-wrapper .overtype-preview .syntax-marker {
      color: var(--syntax-marker, rgba(13, 59, 102, 0.52)) !important;
      opacity: 0.7 !important;
    }

    /* List markers */
    .overtype-wrapper .overtype-preview .list-marker {
      color: var(--list-marker, #ee964b) !important;
    }

    /* Stats bar */
    .overtype-wrapper.with-stats {
      padding-bottom: 40px !important;
    }
    
    .overtype-wrapper .overtype-stats {
      position: absolute !important;
      bottom: 0 !important;
      left: 0 !important;
      right: 0 !important;
      height: 40px !important;
      padding: 0 20px !important;
      background: #f8f9fa !important;
      border-top: 1px solid #e0e0e0 !important;
      display: flex !important;
      justify-content: space-between !important;
      align-items: center !important;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
      font-size: 0.85rem !important;
      color: #666 !important;
      z-index: 2 !important;
    }
    
    /* Dark theme stats bar */
    .overtype-wrapper[data-theme="cave"] .overtype-stats {
      background: var(--bg-secondary, #1D2D3E) !important;
      border-top: 1px solid rgba(197, 221, 232, 0.1) !important;
      color: var(--text, #c5dde8) !important;
    }
    
    .overtype-wrapper .overtype-stats .overtype-stat {
      display: flex !important;
      align-items: center !important;
      gap: 5px !important;
      white-space: nowrap !important;
    }
    
    .overtype-wrapper .overtype-stats .live-dot {
      width: 8px !important;
      height: 8px !important;
      background: #4caf50 !important;
      border-radius: 50% !important;
      animation: pulse 2s infinite !important;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.6; transform: scale(1.2); }
    }
    
    /* Adjust textarea and preview for stats bar */
    .overtype-wrapper.with-stats .overtype-input,
    .overtype-wrapper.with-stats .overtype-preview {
      height: calc(100% - 40px) !important;
    }

    /* Toolbar Styles */
    .overtype-toolbar {
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 8px;
      background: var(--bg-primary, #f8f9fa);
      border: 1px solid var(--border, #e0e0e0);
      border-bottom: none;
      border-radius: 8px 8px 0 0;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }

    .overtype-toolbar-button {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      padding: 0;
      border: none;
      border-radius: 6px;
      background: transparent;
      color: var(--text-secondary, #666);
      cursor: pointer;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .overtype-toolbar-button svg {
      width: 20px;
      height: 20px;
      fill: currentColor;
    }
    
    /* Special sizing for code block icon */
    .overtype-toolbar-button[data-action="insertCodeBlock"] svg {
      width: 24px;
      height: 18px;
      fill: transparent !important;
    }

    .overtype-toolbar-button:hover {
      background: var(--bg-secondary, #e9ecef);
      color: var(--text-primary, #333);
    }

    .overtype-toolbar-button:active {
      transform: scale(0.95);
    }

    .overtype-toolbar-button.active {
      background: var(--primary, #007bff);
      color: white;
    }

    .overtype-toolbar-button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .overtype-toolbar-separator {
      width: 1px;
      height: 24px;
      background: var(--border, #e0e0e0);
      margin: 0 4px;
      flex-shrink: 0;
    }

    /* Adjust wrapper when toolbar is present */
    .overtype-toolbar + .overtype-wrapper {
      border-radius: 0 0 8px 8px;
      border-top: none;
    }

    /* Mobile toolbar adjustments */
    @media (max-width: 640px) {
      .overtype-toolbar {
        padding: 6px;
        gap: 2px;
      }

      .overtype-toolbar-button {
        width: 36px;
        height: 36px;
      }

      .overtype-toolbar-separator {
        margin: 0 2px;
      }
    }

    ${a}
  `}var re=`<svg viewBox="0 0 18 18">
  <path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"></path>
  <path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"></path>
</svg>`,ie=`<svg viewBox="0 0 18 18">
  <line stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" x1="7" x2="13" y1="4" y2="4"></line>
  <line stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" x1="5" x2="11" y1="14" y2="14"></line>
  <line stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" x1="8" x2="10" y1="14" y2="4"></line>
</svg>`,se=`<svg viewBox="0 0 18 18">
  <path fill="currentColor" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z"></path>
</svg>`,ae=`<svg viewBox="0 0 18 18">
  <path fill="currentColor" d="M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"></path>
</svg>`,le=`<svg viewBox="0 0 18 18">
  <path fill="currentColor" d="M16.65186,12.30664a2.6742,2.6742,0,0,1-2.915,2.68457,3.96592,3.96592,0,0,1-2.25537-.6709.56007.56007,0,0,1-.13232-.83594L11.64648,13c.209-.34082.48389-.36328.82471-.1543a2.32654,2.32654,0,0,0,1.12256.33008c.71484,0,1.12207-.35156,1.12207-.78125,0-.61523-.61621-.86816-1.46338-.86816H13.2085a.65159.65159,0,0,1-.68213-.41895l-.05518-.10937a.67114.67114,0,0,1,.14307-.78125l.71533-.86914a8.55289,8.55289,0,0,1,.68213-.7373V8.58887a3.93913,3.93913,0,0,1-.748.05469H11.9873a.54085.54085,0,0,1-.605-.60547V7.59863a.54085.54085,0,0,1,.605-.60547h3.75146a.53773.53773,0,0,1,.60547.59375v.17676a1.03723,1.03723,0,0,1-.27539.748L14.74854,10.0293A2.31132,2.31132,0,0,1,16.65186,12.30664ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"></path>
</svg>`,ce=`<svg viewBox="0 0 18 18">
  <line stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" x1="7" x2="11" y1="7" y2="11"></line>
  <path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"></path>
  <path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"></path>
</svg>`,pe=`<svg viewBox="0 0 18 18">
  <polyline stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" points="5 7 3 9 5 11"></polyline>
  <polyline stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" points="13 7 15 9 13 11"></polyline>
  <line stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" x1="10" x2="8" y1="5" y2="13"></line>
</svg>`,de=`<svg viewBox="0 0 46 33" fill="transparent" xmlns="http://www.w3.org/2000/svg">
  <path d="M35 8h3a5 5 0 0 1 5 5v12a5 5 0 0 1-5 5H18a5 5 0 0 1-5-5v-2" stroke="currentColor" stroke-width="4" stroke-linecap="round"></path>
  <path d="m9 2.5-6 6L9 14M20 2.5l6 6-6 5.5" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"></path>
</svg>`,ue=`<svg viewBox="0 0 18 18">
  <line stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" x1="6" x2="15" y1="4" y2="4"></line>
  <line stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" x1="6" x2="15" y1="9" y2="9"></line>
  <line stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" x1="6" x2="15" y1="14" y2="14"></line>
  <line stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" x1="3" x2="3" y1="4" y2="4"></line>
  <line stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" x1="3" x2="3" y1="9" y2="9"></line>
  <line stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" x1="3" x2="3" y1="14" y2="14"></line>
</svg>`,he=`<svg viewBox="0 0 18 18">
  <line stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" x1="7" x2="15" y1="4" y2="4"></line>
  <line stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" x1="7" x2="15" y1="9" y2="9"></line>
  <line stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" x1="7" x2="15" y1="14" y2="14"></line>
  <line stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" x1="2.5" x2="4.5" y1="5.5" y2="5.5"></line>
  <path fill="currentColor" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"></path>
  <path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"></path>
  <path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"></path>
</svg>`;var N=class{constructor(e){this.editor=e,this.container=null,this.buttons={}}create(){this.container=document.createElement("div"),this.container.className="overtype-toolbar",this.container.setAttribute("role","toolbar"),this.container.setAttribute("aria-label","Text formatting"),[{name:"bold",icon:re,title:"Bold (Ctrl+B)",action:"toggleBold"},{name:"italic",icon:ie,title:"Italic (Ctrl+I)",action:"toggleItalic"},{separator:!0},{name:"h1",icon:se,title:"Heading 1",action:"insertH1"},{name:"h2",icon:ae,title:"Heading 2",action:"insertH2"},{name:"h3",icon:le,title:"Heading 3",action:"insertH3"},{separator:!0},{name:"link",icon:ce,title:"Insert Link (Ctrl+K)",action:"insertLink"},{name:"code",icon:pe,title:"Inline Code",action:"toggleCode"},{name:"codeBlock",icon:de,title:"Code Block",action:"insertCodeBlock"},{separator:!0},{name:"bulletList",icon:ue,title:"Bullet List",action:"toggleBulletList"},{name:"orderedList",icon:he,title:"Numbered List",action:"toggleNumberedList"}].forEach(o=>{if(o.separator){let r=document.createElement("div");r.className="overtype-toolbar-separator",r.setAttribute("role","separator"),this.container.appendChild(r)}else{let r=this.createButton(o);this.buttons[o.name]=r,this.container.appendChild(r)}});let t=this.editor.element.querySelector(".overtype-wrapper");return t&&this.editor.element.insertBefore(this.container,t),this.container}createButton(e){let t=document.createElement("button");return t.className="overtype-toolbar-button",t.type="button",t.title=e.title,t.setAttribute("aria-label",e.title),t.setAttribute("data-action",e.action),t.innerHTML=e.icon,t.addEventListener("click",o=>{o.preventDefault(),this.handleAction(e.action)}),t}async handleAction(e){let t=this.editor.textarea;if(t){t.focus();try{switch(e){case"toggleBold":_(t);break;case"toggleItalic":$(t);break;case"insertH1":P(t,1);break;case"insertH2":P(t,2);break;case"insertH3":P(t,3);break;case"insertLink":j(t);break;case"toggleCode":Q(t);break;case"insertCodeBlock":let o=t.selectionStart,r=t.selectionEnd,s="```\n"+t.value.slice(o,r)+"\n```";t.setRangeText(s,o,r,"end");break;case"toggleBulletList":O(t);break;case"toggleNumberedList":H(t);break}t.dispatchEvent(new Event("input",{bubbles:!0}))}catch(o){console.error("Error loading markdown-actions:",o)}}}async updateButtonStates(){let e=this.editor.textarea;if(e)try{let t=J(e);Object.entries(this.buttons).forEach(([o,r])=>{let i=!1;switch(o){case"bold":i=t.includes("bold");break;case"italic":i=t.includes("italic");break;case"code":i=t.includes("code");break;case"bulletList":i=t.includes("bulletList");break;case"orderedList":i=t.includes("orderedList");break;case"h1":i=t.includes("header1");break;case"h2":i=t.includes("header2");break;case"h3":i=t.includes("header3");break}r.classList.toggle("active",i),r.setAttribute("aria-pressed",i.toString())})}catch(t){}}destroy(){this.container&&(this.container.remove(),this.container=null,this.buttons={})}};var d=class d{constructor(e,t={}){let o;if(typeof e=="string"){if(o=document.querySelectorAll(e),o.length===0)throw new Error(`No elements found for selector: ${e}`);o=Array.from(o)}else if(e instanceof Element)o=[e];else if(e instanceof NodeList)o=Array.from(e);else if(Array.isArray(e))o=e;else throw new Error("Invalid target: must be selector string, Element, NodeList, or Array");return o.map(i=>{if(i.overTypeInstance)return i.overTypeInstance.reinit(t),i.overTypeInstance;let s=Object.create(d.prototype);return s._init(i,t),i.overTypeInstance=s,d.instances.set(i,s),s})}_init(e,t={}){this.element=e,this.options=this._mergeOptions(t),this.instanceId=++d.instanceCount,this.initialized=!1,d.injectStyles(),d.initGlobalListeners();let o=e.querySelector(".overtype-wrapper");o?this._recoverFromDOM(o):this._buildFromScratch(),this.shortcuts=new T(this),this.options.toolbar&&(this.toolbar=new N(this),this.toolbar.create(),this.textarea.addEventListener("selectionchange",()=>{this.toolbar.updateButtonStates()}),this.textarea.addEventListener("input",()=>{this.toolbar.updateButtonStates()})),this.initialized=!0,this.options.onChange&&this.options.onChange(this.getValue(),this)}_mergeOptions(e){let t={fontSize:"14px",lineHeight:1.6,fontFamily:"'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace",padding:"16px",mobile:{fontSize:"16px",padding:"12px",lineHeight:1.5},autofocus:!1,placeholder:"Start typing...",value:"",onChange:null,onKeydown:null,showActiveLineRaw:!1,showStats:!1,toolbar:!1,statsFormatter:null},{theme:o,colors:r,...i}=e;return{...t,...i}}_recoverFromDOM(e){if(this.wrapper=e,this.textarea=e.querySelector(".overtype-input"),this.preview=e.querySelector(".overtype-preview"),!this.textarea||!this.preview){e.remove(),this._buildFromScratch();return}this.wrapper._instance=this,this.options.fontSize&&this.wrapper.style.setProperty("--instance-font-size",this.options.fontSize),this.options.lineHeight&&this.wrapper.style.setProperty("--instance-line-height",String(this.options.lineHeight)),this.options.padding&&this.wrapper.style.setProperty("--instance-padding",this.options.padding),this._configureTextarea(),this._applyOptions()}_buildFromScratch(){let e=this._extractContent();this.element.innerHTML="",this._createDOM(),(e||this.options.value)&&this.setValue(e||this.options.value),this._applyOptions()}_extractContent(){let e=this.element.querySelector(".overtype-input");return e?e.value:this.element.textContent||""}_createDOM(){this.wrapper=document.createElement("div"),this.wrapper.className="overtype-wrapper";let e=d.currentTheme||C,t=typeof e=="string"?e:e.name;t&&this.wrapper.setAttribute("data-theme",t),this.options.showStats&&this.wrapper.classList.add("with-stats"),this.options.fontSize&&this.wrapper.style.setProperty("--instance-font-size",this.options.fontSize),this.options.lineHeight&&this.wrapper.style.setProperty("--instance-line-height",String(this.options.lineHeight)),this.options.padding&&this.wrapper.style.setProperty("--instance-padding",this.options.padding),this.wrapper._instance=this,this.textarea=document.createElement("textarea"),this.textarea.className="overtype-input",this.textarea.placeholder=this.options.placeholder,this._configureTextarea(),this.preview=document.createElement("div"),this.preview.className="overtype-preview",this.preview.setAttribute("aria-hidden","true"),this.wrapper.appendChild(this.textarea),this.wrapper.appendChild(this.preview),this.options.showStats&&(this.statsBar=document.createElement("div"),this.statsBar.className="overtype-stats",this.wrapper.appendChild(this.statsBar),this._updateStats()),this.element.appendChild(this.wrapper)}_configureTextarea(){this.textarea.setAttribute("autocomplete","off"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.setAttribute("data-gramm","false"),this.textarea.setAttribute("data-gramm_editor","false"),this.textarea.setAttribute("data-enable-grammarly","false")}_applyOptions(){this.options.autofocus&&this.textarea.focus(),this.updatePreview()}updatePreview(){let e=this.textarea.value,t=this.textarea.selectionStart,o=this._getCurrentLine(e,t),r=B.parse(e,o,this.options.showActiveLineRaw);this.preview.innerHTML=r||'<span style="color: #808080;">Start typing...</span>',this._applyCodeBlockBackgrounds(),this.options.showStats&&this.statsBar&&this._updateStats(),this.options.onChange&&this.initialized&&this.options.onChange(e,this)}_applyCodeBlockBackgrounds(){let e=this.preview.querySelectorAll(".code-fence");for(let t=0;t<e.length-1;t+=2){let o=e[t],r=e[t+1],i=o.parentElement,s=r.parentElement;if(!i||!s)continue;o.style.display="block",r.style.display="block",i.classList.add("code-block-line"),s.classList.add("code-block-line");let a=i.nextElementSibling;for(;a&&a!==s&&(a.tagName==="DIV"&&a.classList.add("code-block-line"),a=a.nextElementSibling,!!a););}}_getCurrentLine(e,t){return e.substring(0,t).split(`
`).length-1}handleInput(e){this.updatePreview()}handleKeydown(e){!this.shortcuts.handleKeydown(e)&&this.options.onKeydown&&this.options.onKeydown(e,this)}handleScroll(e){this.preview.scrollTop=this.textarea.scrollTop,this.preview.scrollLeft=this.textarea.scrollLeft}getValue(){return this.textarea.value}setValue(e){this.textarea.value=e,this.updatePreview()}focus(){this.textarea.focus()}blur(){this.textarea.blur()}isInitialized(){return this.initialized}reinit(e={}){this.options=this._mergeOptions({...this.options,...e}),this._applyOptions(),this.updatePreview()}_updateStats(){if(!this.statsBar)return;let e=this.textarea.value,t=e.split(`
`),o=e.length,r=e.split(/\s+/).filter(l=>l.length>0).length,i=this.textarea.selectionStart,a=e.substring(0,i).split(`
`),c=a.length,y=a[a.length-1].length+1;this.options.statsFormatter?this.statsBar.innerHTML=this.options.statsFormatter({chars:o,words:r,lines:t.length,line:c,column:y}):this.statsBar.innerHTML=`
          <div class="overtype-stat">
            <span class="live-dot"></span>
            <span>${o} chars, ${r} words, ${t.length} lines</span>
          </div>
          <div class="overtype-stat">Line ${c}, Col ${y}</div>
        `}showStats(e){this.options.showStats=e,e&&!this.statsBar?(this.statsBar=document.createElement("div"),this.statsBar.className="overtype-stats",this.wrapper.appendChild(this.statsBar),this.wrapper.classList.add("with-stats"),this._updateStats()):!e&&this.statsBar&&(this.statsBar.remove(),this.statsBar=null,this.wrapper.classList.remove("with-stats"))}destroy(){if(this.element.overTypeInstance=null,d.instances.delete(this.element),this.shortcuts&&this.shortcuts.destroy(),this.wrapper){let e=this.getValue();this.wrapper.remove(),this.element.textContent=e}this.initialized=!1}static init(e,t={}){return new d(e,t)}static getInstance(e){return e.overTypeInstance||d.instances.get(e)||null}static destroyAll(){document.querySelectorAll("[data-overtype-instance]").forEach(t=>{let o=d.getInstance(t);o&&o.destroy()})}static injectStyles(e=!1){if(d.stylesInjected&&!e)return;let t=document.querySelector("style.overtype-styles");t&&t.remove();let o=d.currentTheme||C,r=oe({theme:o}),i=document.createElement("style");i.className="overtype-styles",i.textContent=r,document.head.appendChild(i),d.stylesInjected=!0}static setTheme(e,t=null){let o=typeof e=="string"?z(e):e;t&&(o=ne(o,t)),d.currentTheme=o,d.injectStyles(!0),document.querySelectorAll(".overtype-wrapper").forEach(r=>{let i=typeof o=="string"?o:o.name;i&&r.setAttribute("data-theme",i);let s=r._instance;s&&s.updatePreview()})}static initGlobalListeners(){d.globalListenersInitialized||(document.addEventListener("input",e=>{if(e.target&&e.target.classList&&e.target.classList.contains("overtype-input")){let t=e.target.closest(".overtype-wrapper"),o=t==null?void 0:t._instance;o&&o.handleInput(e)}}),document.addEventListener("keydown",e=>{if(e.target&&e.target.classList&&e.target.classList.contains("overtype-input")){let t=e.target.closest(".overtype-wrapper"),o=t==null?void 0:t._instance;o&&o.handleKeydown(e)}}),document.addEventListener("scroll",e=>{if(e.target&&e.target.classList&&e.target.classList.contains("overtype-input")){let t=e.target.closest(".overtype-wrapper"),o=t==null?void 0:t._instance;o&&o.handleScroll(e)}},!0),document.addEventListener("selectionchange",e=>{let t=document.activeElement;if(t&&t.classList.contains("overtype-input")){let o=t.closest(".overtype-wrapper"),r=o==null?void 0:o._instance;r&&(r.options.showStats&&r.statsBar&&r._updateStats(),clearTimeout(r._selectionTimeout),r._selectionTimeout=setTimeout(()=>{r.updatePreview()},50))}}),d.globalListenersInitialized=!0)}};A(d,"instances",new WeakMap),A(d,"stylesInjected",!1),A(d,"globalListenersInitialized",!1),A(d,"instanceCount",0);var x=d;x.MarkdownParser=B;x.ShortcutsManager=T;x.themes={solar:C,cave:z("cave")};x.getTheme=z;x.currentTheme=C;var Ne=x;return ke(Fe);})();
/**
 * OverType - A lightweight markdown editor library with perfect WYSIWYG alignment
 * @version 1.0.0
 * @license MIT
 */
window.OverType = OverType.OverType || OverType.default || OverType;
